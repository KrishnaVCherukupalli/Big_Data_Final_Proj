{% extends "layout.html" %}
{% block title %}Debts{% endblock %}
{% block content %}

<h2>üí≥ My Debts</h2>

<form method="POST">
    <input name="lender_name" placeholder="Lender Name" required>
    <input name="total_amount" type="number" step="0.01" placeholder="Total Amount" required>
    <input name="paid_amount" type="number" step="0.01" placeholder="Paid Amount">
    <input name="interest_rate" type="number" step="0.01" placeholder="Interest Rate %">
    <input name="due_date" type="date" required>
    <button type="submit">Add Debt</button>
</form>

<hr>

<table border="1" cellpadding="8">
    <thead>
        <tr><th>Lender</th><th>Total</th><th>Paid</th><th>Interest</th><th>Due</th><th>Progress</th><th>Actions</th></tr>
    </thead>
    <tbody>
        {% for d in debts %}
        <tr>
            <td>{{ d.lender_name }}</td>
            <td>${{ "%.2f"|format(d.total_amount) }}</td>
            <td>${{ "%.2f"|format(d.paid_amount) }}</td>
            <td>{{ d.interest_rate or 0 }}%</td>
            <td>{{ d.due_date.strftime('%Y-%m-%d') }}</td>
            <td>
                {% set progress = (d.paid_amount / d.total_amount * 100) if d.total_amount else 0 %}
                <progress value="{{ progress|round(0) }}" max="100"></progress>
                {{ progress|round(1) }}%
            </td>
            <td>
                <a href="/edit_debt/{{ d.debt_id }}">‚úèÔ∏è Edit</a> |
                <a href="/delete_debt/{{ d.debt_id }}" onclick="return confirm('Delete this debt?')">‚ùå Delete</a>
            </td>
        </tr>
        {% else %}
        <tr><td colspan="7">No debts found</td></tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
