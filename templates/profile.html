{% extends "layout.html" %}

{% block title %}Profile - Expense Tracker{% endblock %}

{% block content %}
<h2>👤 User Profile</h2>

{% with messages = get_flashed_messages() %}
  {% if messages %}
<ul class="flash-messages">
    {% for message in messages %}
    <li style="color: green;">{{ message }}</li>
    {% endfor %}
</ul>
  {% endif %}
{% endwith %}


<p><strong>Full Name:</strong> {{ user.full_name }}</p>
<p><strong>Email:</strong> {{ user.email }}</p>
<p><strong>Account Created:</strong> {{ user.created_at.strftime('%B %d, %Y') }}</p>

<hr>
<h3>📊 Activity Summary</h3>
<ul>
    <li>Total Transactions: {{ transaction_count }}</li>
    <li>Budgets Created: {{ budget_count }}</li>
    <li>Savings Goals: {{ savings_count }}</li>
    <li>Linked Accounts: {{ account_count }}</li>

    <a href="/accounts">➕ Manage Linked Accounts</a>

</ul>

<hr>
<h3>🔐 Change Password</h3>
<form method="POST" action="/change_password">
    <input type="password" name="current_password" placeholder="Current Password" required><br><br>
    <input type="password" name="new_password" placeholder="New Password" required><br><br>
    <input type="password" name="confirm_password" placeholder="Confirm New Password" required><br><br>
    <button type="submit">Update Password</button>
</form>

<hr>
<h3 style="color: red;">⚠️ Delete Account</h3>
<form method="POST" action="/delete_account" onsubmit="return confirm('Are you sure? This will permanently delete your account.')">
    <button type="submit" style="color: red;">Delete Account</button>
</form>

<h2>Set Default Currency</h2>
<form action="/update_currency" method="post">
    <select name="currency">
        <option value="CAD" {% if user.currency == "CAD" %}selected{% endif %}>CAD</option>
        <option value="USD" {% if user.currency == "USD" %}selected{% endif %}>USD</option>
        <option value="EUR" {% if user.currency == "EUR" %}selected{% endif %}>EUR</option>
        <option value="INR" {% if user.currency == "INR" %}selected{% endif %}>INR</option>
        <!-- Add more if needed -->
    </select>
    <button type="submit">Update Currency</button>
</form>
{% endblock %}
